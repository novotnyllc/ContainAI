# fn-13-1c7.6 Investigate Sysbox compatibility with devcontainer patterns

## Description
Investigate which devcontainer patterns are compatible with Sysbox runtime (ContainAI's security foundation) and which break. Produce a compatibility matrix with evidence.

**Size:** S
**Files:** Output to `.flow/research/fn-13-1c7/sysbox-compatibility.md`

## Approach

1. Review Sysbox documentation for limitations:
   - Which capabilities are virtualized vs blocked?
   - What happens when a container requests `--privileged`?
   - How does user namespace remapping affect devcontainer users?

2. **Define compatibility matrix template**:
   | Pattern | Expectation | Evidence Type | Result |
   |---------|-------------|---------------|--------|
   | ... | Determine with evidence | doc-link / empirical-test / inferred | ... |

3. **Patterns to evaluate** (explicit list):
   - Docker-in-Docker feature (Sysbox's strength)
   - `--privileged` requests (determine actual behavior)
   - Custom user configurations (`remoteUser`, `containerUser`)
   - Volume mounts to protected paths
   - User namespace/UID mapping (`updateRemoteUserUID`)
   - Kernel sysctls (some devcontainers need these)

4. Document workarounds for incompatible patterns

## Key context

ContainAI uses Sysbox for secure Docker-in-Docker without `--privileged`. Key Sysbox behaviors:
- Runs containers in user namespace (root â†’ unprivileged)
- Virtualizes /proc, /sys for nested containers
- Allows DinD without privileged mode
- May block some kernel-level operations

Reference: `/home/claire/dev/ContainAI/.flow/specs/fn-10-vep.md`

**Evidence types**:
- `doc-link`: Sysbox documentation states behavior
- `empirical-test`: Tested in actual Sysbox environment
- `inferred`: Reasonable expectation based on related docs

## Acceptance
- [ ] Sysbox capability limitations documented with sources
- [ ] Compatibility matrix template used consistently
- [ ] Docker-in-Docker compatibility confirmed (doc or test)
- [ ] `--privileged` mode handling documented with evidence
- [ ] User namespace implications analyzed
- [ ] Each pattern has evidence type documented
- [ ] Workarounds for incompatible patterns noted

## Done summary
Analyzed Sysbox runtime compatibility with 12 devcontainer patterns. Created comprehensive compatibility matrix with per-row evidence classification (doc-link/inferred/empirical-test). Key finding: ~90% of patterns are compatible, with Docker-in-Docker being Sysbox's major strength. Documented workarounds for incompatible patterns and kernel version requirements.
## Evidence
- Commits: 19dd954, 07ab05d, 552828472f7c90aaa427be4d9be9d90328ed3458
- Tests: codex impl-review (SHIP)
- PRs:
