# fn-13-1c7.1 Security audit devcontainer.json schema

## Description
Create a comprehensive security classification of every property in the devcontainer.json schema, categorizing each as SAFE, FILTERED, BLOCKED, or WARN based on its risk to ContainAI's sandbox model.

**Size:** M
**Files:** Output to `.flow/research/fn-13-1c7/security-classification.md`

## Approach

1. Pin to actual JSON Schema source from https://github.com/devcontainers/spec/tree/main/schemas (record exact version/commit)
2. Use the human reference page (json_reference) only for semantics/examples
3. For each property, analyze:
   - Does it run code on the host? (BLOCKED)
   - Does it grant elevated privileges? (BLOCKED or FILTERED)
   - Does it mount sensitive paths? (FILTERED)
   - Is it purely informational? (SAFE)
4. Document justification for each classification
5. Add **Execution scope** column per property:
   - **Host-machine**: Runs on user's actual host (most dangerous)
   - **Sandbox-host**: Runs inside Sysbox container's "host" (already sandboxed)
   - **Devcontainer**: Runs inside the nested devcontainer (most isolated)
6. Add **Default action in cai** column per property

## Security Categories (use these definitions)

| Category | Definition | Enforcement | Default Action |
|----------|------------|-------------|----------------|
| **SAFE** | No security implications | None | Pass through unchanged |
| **FILTERED** | Needs sanitization | Transform before use | Apply filter, use safe subset |
| **BLOCKED** | Inherently dangerous | Hard error | Reject with error message |
| **WARN** | May be risky but allowed | Log warning | Allow but log, suggest review |

## Key Properties to Focus On

- `initializeCommand` (runs on HOST - highest risk, but different if "host" is Sysbox)
- `runArgs` (can include --privileged, volume mounts)
- `mounts` (can escape sandbox)
- `capAdd`, `securityOpt` (privilege escalation)
- Feature properties (`privileged`, `capAdd` in features)
- `build`/`dockerFile` (where does build run?)

## Key context

Threat model: Classification is primarily about *host boundary / privilege escalation / unexpected host-side execution*. Network exfil is expected risk per SECURITY.md; WARN only for surprising automatic code execution.

## Acceptance
- [ ] Exact JSON Schema version/commit recorded
- [ ] All devcontainer.json root properties classified
- [ ] All lifecycle command properties analyzed with host vs container execution noted
- [ ] Feature-related properties analyzed
- [ ] **Execution scope** column included (host-machine vs sandbox-host vs devcontainer)
- [ ] **Default action in cai** column included
- [ ] Each classification has security justification
- [ ] Document includes recommendation for handling each category

## Done summary
TBD

## Evidence
- Commits:
- Tests:
- PRs:
