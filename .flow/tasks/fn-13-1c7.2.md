# fn-13-1c7.2 Analyze real-world devcontainer usage patterns

## Description
Analyze how devcontainers are used in real-world projects to understand which properties are commonly used, which features are popular, and what percentage of existing devcontainers would work with a restricted parser.

**Size:** M
**Files:** Output to `.flow/research/fn-13-1c7/usage-analysis.md`

## Approach

1. **Define selection criteria** (stratified sampling):
   - Sample by ecosystem: Node.js, Python, Go, Rust, Java (10 repos each = 50 base)
   - Stratify by stars: 10k+, 1k-10k, <1k (capture both popular and typical)
   - Cap per organization (max 2 repos per org to avoid bias)
   - Handle monorepos: count each `.devcontainer/*` config separately
2. **Document JSONC parsing approach**:
   - Use `hjson` Python library or strip comments before jq
   - Record parsing failures separately
3. Track frequency of each property across repos
4. Identify common patterns:
   - Most used features (docker-in-docker, node, python, etc.)
   - Common runArgs patterns
   - Lifecycle command usage (`initializeCommand` prevalence!)
5. Estimate what % would work if we:
   - Block initializeCommand
   - Block privileged mode
   - Restrict mounts to workspace only

## Output Format

- Raw counts + methodology (reproducible)
- Property frequency table with percentages
- Feature usage statistics
- "Safe subset" compatibility percentage (simple proportion with sample size for context)
- Notable outliers/patterns

## Key context

Look at repos from diverse ecosystems:
- Node.js/TypeScript projects
- Python projects
- Go projects
- Rust projects
- Multi-language monorepos

## Acceptance
- [ ] Selection criteria documented (stratification, caps, dedup)
- [ ] JSONC parsing methodology documented
- [ ] At least 50 devcontainer.json files analyzed
- [ ] Property frequency table produced with percentages
- [ ] Feature usage statistics gathered
- [ ] initializeCommand prevalence specifically noted
- [ ] Estimate of "safe subset" compatibility with methodology
- [ ] Common patterns documented with examples

## Done summary
## Summary

Analyzed 51 real-world devcontainer.json configurations from popular GitHub repositories across JavaScript/TypeScript, Python, Go, Rust, and Java ecosystems.

### Key Findings

1. **initializeCommand is not used** (0% of repos) - blocking it has zero impact on compatibility

2. **86% of configs work with ContainAI's security model** out of the box (no privileged mode required)

3. **Most popular properties**: customizations (72%), features (68%), postCreateCommand (64%), image (64%)

4. **Docker-in-Docker is popular** (22% of repos) - ContainAI's Sysbox runtime handles this without --privileged

5. **Lifecycle commands are safe** - all run inside the container, not on host

### Safe Subset Compatibility

- Conservative (block initializeCommand only): **100%**
- Strict (block initializeCommand + privileged): **86%**

### Output

Research document: `.flow/research/fn-13-1c7/usage-analysis.md`
- Methodology and selection criteria documented
- 51 devcontainer.json files analyzed
- Property frequency table with percentages
- Feature usage statistics
- initializeCommand prevalence: 0%
- Safe subset compatibility estimate with methodology
- Common patterns documented with examples
## Evidence
- Commits:
- Tests:
- PRs:
