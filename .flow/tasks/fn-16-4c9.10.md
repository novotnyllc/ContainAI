# fn-16-4c9.10 Fix macOS mirrored volume path

## Description

On macOS, workspace paths using `pwd -P` resolve symlinks to their physical paths (e.g., `/private/var/...`), but Lima mounts use the logical paths (e.g., `/var/...`). This mismatch causes Docker volume mounts to fail because the physical path doesn't exist in the VM.

**Problem reproduction:**
```bash
# User's path (logical)
cd /var/folders/tmp/myproject
pwd     # /var/folders/tmp/myproject
pwd -P  # /private/var/folders/tmp/myproject (physical)

# Docker volume mount fails because Lima mounts /var, not /private/var
docker run -v /private/var/folders/tmp/myproject:/workspace ...
# ERROR: path not found in VM
```

**Root cause locations (ALL must be updated):**
- `src/containai.sh:628` - `pwd -P`
- `src/containai.sh:868` - `pwd -P`
- `src/containai.sh:972` - `pwd -P`
- `src/containai.sh:1351` - `pwd -P`
- `src/containai.sh:1872` - `pwd -P`
- `src/lib/container.sh:275` - `pwd -P` in `_cai_hash_path()`
- `src/lib/container.sh:1212` - `pwd -P` in workspace resolution

**Solution:**

1. Add platform-aware path normalization helper to `src/lib/platform.sh`:
   ```bash
   # Normalize path with platform-appropriate symlink handling
   # macOS: preserve symlinks (pwd -L) for Lima mount compatibility
   # Linux: resolve symlinks (pwd -P) for consistency
   _cai_normalize_path() {
       local path="$1"
       local normalized

       if [[ "$(_cai_detect_platform)" == "macos" ]]; then
           # macOS: preserve symlinks for Lima mount compatibility
           normalized=$(cd -- "$path" 2>/dev/null && pwd -L) || normalized="$path"
       else
           # Linux: resolve symlinks for consistency
           normalized=$(cd -- "$path" 2>/dev/null && pwd -P) || normalized="$path"
       fi

       printf '%s' "$normalized"
   }
   ```

2. Update `_cai_hash_path()` in `src/lib/container.sh`:
   ```bash
   _cai_hash_path() {
       local path="$1"
       local normalized hash

       # Use platform-aware normalization
       normalized=$(_cai_normalize_path "$path")

       # Hash computation (unchanged)...
   }
   ```

3. Update ALL workspace resolution sites in `src/containai.sh`:
   Replace each `cd -- "$path" && pwd -P` with `_cai_normalize_path "$path"`

4. Update `src/lib/container.sh:1212`:
   Replace `pwd -P` with `_cai_normalize_path`

**Files to modify:**
- `src/lib/platform.sh`: Add `_cai_normalize_path()` helper
- `src/lib/container.sh`: Update `_cai_hash_path()` and line 1212
- `src/containai.sh`: Update all 5 workspace resolution sites

## Acceptance
- [ ] `_cai_normalize_path()` helper added to src/lib/platform.sh
- [ ] Helper uses pwd -L on macOS (preserve symlinks)
- [ ] Helper uses pwd -P on Linux (resolve symlinks)
- [ ] `_cai_hash_path()` uses `_cai_normalize_path()`
- [ ] ALL pwd -P sites in src/containai.sh updated
- [ ] src/lib/container.sh:1212 updated
- [ ] Docker volume mounts work with symlinked paths on macOS
- [ ] Hash computation is consistent (same logical path = same hash)
- [ ] Linux behavior unchanged (still resolves symlinks)
- [ ] Test: /var/folders/... path works correctly on macOS

## Done summary
TBD

## Evidence
- Commits:
- Tests:
- PRs:
