# Container UX & Templates

## Overview

Improve container lifecycle management with auto-creation, consistent parameter handling, custom templates, and shell completion. Remove legacy cai sandbox command.

## Scope

**In scope:**
- cai shell auto-creates/starts container if none exists
- All commands accept --container parameter to override defaults
- Container name completion for existing containers
- Custom user image templates via Dockerfiles
- Template parameter with autocompletion
- Remove cai sandbox (no legacy/backcompat)

**Out of scope:**
- Multi-container orchestration
- Devcontainer integration (fn-13-1c7)

## Custom Templates

Users can create custom Dockerfiles in:
```
~/.config/containai/templates/
├── ml-gpu/
│   └── Dockerfile      # FROM ghcr.io/containai/agents:latest
├── frontend/
│   └── Dockerfile
└── my-custom/
    └── Dockerfile
```

Usage:
```bash
cai shell --template ml-gpu
cai run --template frontend
```

Template Dockerfile pattern:
```dockerfile
# Must be based on ContainAI image
FROM ghcr.io/containai/agents:latest

# User customizations
RUN apt-get update && apt-get install -y cuda-toolkit
```

## Container Name Parameter

All workspace commands accept `--container <name>`:
```bash
cai shell --container my-project
cai run --container my-project
cai exec --container my-project echo hello
cai import --container my-project
cai stop --container my-project
```

Default container selection:
1. Explicit --container parameter
2. Workspace-associated container (from fn-12-css)
3. Auto-generated from workspace path

## Shell Completion

Tab completion for:
- Container names (existing containers for current workspace)
- Template names (from ~/.config/containai/templates/)
- Common command options

Completion providers for:
- bash
- zsh
- fish

## Quick commands

```bash
# Test auto-create
cai shell  # Should create if none exists

# Test template
cai shell --template ml-gpu

# Test container override
cai shell --container my-test

# List templates
ls ~/.config/containai/templates/
```

## Acceptance

- [ ] cai shell auto-creates container if none exists
- [ ] cai shell auto-starts stopped container
- [ ] --container parameter works on shell, run, exec, import, export, stop
- [ ] Default container derived from workspace if not specified
- [ ] Custom templates read from ~/.config/containai/templates/
- [ ] --template parameter builds from user Dockerfile
- [ ] Template autocompletion works (bash, zsh)
- [ ] Container name autocompletion works
- [ ] cai sandbox removed (command not found)
- [ ] No backwards compatibility shims

## References

- Workspace state: fn-12-css
- Bash completion: https://www.gnu.org/software/bash/manual/html_node/Programmable-Completion.html
- Zsh completion: https://zsh.sourceforge.io/Doc/Release/Completion-System.html

## Dependencies

- **fn-12-css**: Workspace state persistence (for default container selection)
- **fn-16-4c9.1**: Project reorg (clean paths)
